@model SaleManagement.Protal.Models.Order.OrderListItemViewModel
@using Dickson.Core.Common.Extensions
@{
    ViewBag.Title = "订单详情";
    Layout = null;

}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    @Styles.Render("~/Bundles/Static/Css/Bootstrap")
    @Styles.Render("~/Bundles/Static/Css/Layout")

    <style type="text/css">
        body{
            color:#000000;
        }

        .table {
            margin-bottom: 0px;
        }

            .table thead > tr > th, .table tbody > tr > th, .table tfoot > tr > th, .table thead > tr > td, .table tbody > tr > td, .table tfoot > tr > td {
                padding: 3px;
                border: 1px solid #000000;
            }

            .table tr th {
                background-color: #ffffff;
                font-weight: normal;
            }
        .hightTd{
            background:#e2f1f1!important; 
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#e2f1f1', endColorstr='#e2f9f9', GradientType=0);  
        }
        .text-right{
            text-align:right;
        }
    </style>
</head>
<body>
    @{
        var isEmployee = User.IdentityType == SaleManagement.Core.Models.IdentityType.Employee;
    }
    <div style="margin:0px auto; width:980px;border:1px solid #e2f1f1">
        @if (isEmployee)
        {
            <div class="pull-right"><button id="btnPrint" class="btn btn-primary" onclick="printClick()">打印</button></div>
        }
        <div id="divPrint">
            <div class="text-center">
                <h4>镜像生产单</h4>
            </div>
            <table class="table table-bordered bootstrap-datatable" border="1">
                <tbody>
                    <tr>
                        <td colspan="2" class="text-center">订单号：@Model.Id</td>
                        <td colspan="2" class="text-center">制单日期：@Model.Created</td>
                        <td colspan="2" class="text-center">预计交货日期：@Model.DeliveryDate</td>
                    </tr>
                    <tr>
                        <td colspan="2" class="text-center">成色：<span style="background-color:#b6ff00">@Model.ColorFormName</span></td>
                        <td colspan="2" class="text-center">客户：@Model.CustomerName</td>
                        <td colspan="2" class="text-center">制单人：@Model.CreatorName</td>
                    </tr>
                    <tr>
                        <td class="hightTd text-right">宝石</td><td class="hightTd text-center"> @Model.GemCategoryName</td>
                        <td class="hightTd text-right">主石镶口要求</td><td class="hightTd text-center"> @Model.RabbetRequirement.GetDisplayName()</td>
                        <td colspan="2" class="hightTd">字印要求：@Model.WordsPrinted</td>
                    </tr>
                    <tr>
                        <td class="text-right">品类</td><td class="text-center">@Model.ProductCategoryName</td>
                        <td class="text-right">金重控制要求</td><td class="text-center">@Model.GoldWeightRequirement.GetDisplayName()</td>
                        <td rowspan="5" width="35%">备注：@Model.Remark</td>
                    </tr>
                    <tr>
                        <td class="hightTd text-right">指圈</td><td class="hightTd text-center">@Model.RangSize</td>
                        <td class="hightTd text-right">副石控制要求</td><td class="hightTd text-center">@Model.SideStoneRequiredment.GetDisplayName()</td>
                    </tr>
                    <tr>
                        <td class="text-right">件数</td><td class="text-center">@Model.Number</td>
                        <td class="text-right">戒臂内弧要求</td><td class="text-center">@Model.RadianRequirement.GetDisplayName()</td>
                    </tr>
                    <tr>
                        <td class="hightTd text-right">主石重</td><td class="hightTd text-center">@Model.MainStoneSize</td>
                        <td class="hightTd text-right">客来石描述</td><td class="hightTd text-center">@Model.StoneDescribe.GetDisplayName()</td>
                    </tr>
                    <tr>
                        <td class="text-right">证书号</td><td class="text-center">@Model.Certificate</td>
                        <td class="text-right">有无旧料</td><td class="text-center">@(Model.HasOldMaterial ? "有" : "无")</td>
                    </tr>
                </tbody>
            </table>
            @*<div>
                <div class="col-md-4 col-xs-4">订单号：@Model.Id</div>
                <div class="col-md-4 col-xs-4">客户：@Model.CustomerName</div>
                <div class="col-md-4 col-xs-4">制单人：@Model.CreatorName</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">制单日期：@Model.Created</div>
                <div class="col-md-4 col-xs-4">预计交货日期：@Model.DeliveryDate</div>
                <div class="col-md-4 col-xs-4">订单状态：@Model.StatusName</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">成色：@Model.ColorFormName</div>
                <div class="col-md-4 col-xs-4">宝石：@Model.GemCategoryName</div>
                <div class="col-md-4 col-xs-4">品类：@Model.ProductCategoryName</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">指圈：@Model.RangSize</div>
                <div class="col-md-4 col-xs-4">主石重：@Model.MainStoneSize</div>
                <div class="col-md-4 col-xs-4">件数：@Model.Number</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">主石镶口要求：@Model.RabbetRequirement.GetDisplayName()</div>
                <div class="col-md-4 col-xs-4">客来石描述：@Model.StoneDescribe.GetDisplayName()</div>
                <div class="col-md-4 col-xs-4">金重控制要求：@Model.GoldWeightRequirement.GetDisplayName()</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">副石控制要求：@Model.SideStoneRequiredment.GetDisplayName()</div>
                <div class="col-md-4 col-xs-4">戒臂内弧要求：@Model.RadianRequirement.GetDisplayName()</div>
                <div class="col-md-4 col-xs-4">有无旧料：@(Model.HasOldMaterial ? "有" : "无")</div>
            </div>
            <div>
                <div class="col-md-4 col-xs-4">证书号：@Model.Certificate</div>
                <div class="col-md-4 col-xs-4">字印要求：@Model.WordsPrinted</div>
                <div class="col-md-4 col-xs-4">客户加急：@Model.OrderRushStatusName</div>
            </div>

            <div>
                <div class="col-md-12 col-xs-12" style="height:20px">备注：@Model.Remark</div>
            </div>*@
            <div class="ptop5" style="min-height:590px;width:800px; margin-left:5px;display:inline-block" id="divImage">
                @{
                    foreach (var item in Model.Attachments)
                    {
                        var previewUrl = "/Attachment/" + @item.Id + "/preview";
                        <div style="float:left;margin-left:5px;">
                            <a class="cboxElement" target="_blank" onclick="window.open('@previewUrl')" href="javascript:void(0);"><img height="295" width="300" src="@item.Url"></a>
                        </div>
                    }
                }
            </div>
            @if (isEmployee)
            {
                <table class="table table-bordered bootstrap-datatable">
                    <tbody>
                        <tr>
                            <th>部门</th>
                            <th>日期</th>
                            <th>发货重</th>
                            <th>员工签名</th>
                            <th>收货重</th>
                            <th>主石</th>
                            <th>副石</th>
                            <th>粒数</th>
                            <th>员工签名</th>
                            <th>件数</th>
                            <th>备注</th>
                        </tr>
                        <tr>
                            <td>执模</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>出水</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>微镶</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>手镶</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>抛光</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>打包</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            }
        </div>
    </div>
</body>
</html>
@Scripts.Render("~/bundles/Static/js/jquery")
<script type="text/javascript">
    function printClick() {
        var headstr = "<html><head><title></title></head><body>";
        var footstr = "</body>";
        var newstr = document.all.item("divPrint").innerHTML;
        var oldstr = document.body.innerHTML;
        document.body.innerHTML = headstr + newstr + footstr;
        window.print();
        document.body.innerHTML = oldstr;
        return false;
    }
</script>
